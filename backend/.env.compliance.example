# Compliance System Configuration
# Copy to .env and update values for your environment

# ============================================================================
# Compliance Feature Flags
# ============================================================================

# Enable compliance system
COMPLIANCE_ENABLED=true

# Enable MiFID II RTS 27/28 reporting
COMPLIANCE_MIFID_II=true

# Enable SEC Rule 606 reporting
COMPLIANCE_SEC_RULE_606=true

# Require admin authentication for compliance endpoints
COMPLIANCE_ADMIN_ONLY=true

# Enable tamper-proof audit logging
COMPLIANCE_TAMPER_PROOF=true

# ============================================================================
# Data Retention
# ============================================================================

# Audit log retention period (years)
# MiFID II requires 7 years, SEC requires 3-6 years
AUDIT_RETENTION_YEARS=7

# Automatically archive old records to cold storage
COMPLIANCE_AUTO_ARCHIVE=true

# Archive storage path (local or S3)
COMPLIANCE_ARCHIVE_PATH=./data/compliance_reports

# S3 bucket for long-term archival (optional)
# AWS_S3_BUCKET=my-compliance-archive
# AWS_S3_REGION=us-east-1
# AWS_S3_STORAGE_CLASS=GLACIER

# ============================================================================
# Report Generation
# ============================================================================

# Default report format (json, csv, pdf)
COMPLIANCE_DEFAULT_FORMAT=json

# Enable PDF generation (requires wkhtmltopdf or gofpdf)
COMPLIANCE_PDF_ENABLED=false

# PDF generation service endpoint (optional)
# COMPLIANCE_PDF_SERVICE_URL=http://localhost:8080/generate-pdf

# Maximum report size (rows)
COMPLIANCE_MAX_REPORT_ROWS=100000

# Report cache TTL (seconds)
COMPLIANCE_REPORT_CACHE_TTL=3600

# ============================================================================
# Alerts
# ============================================================================

# Enable compliance alerts
COMPLIANCE_ALERTS_ENABLED=true

# Alert email recipients (comma-separated)
COMPLIANCE_ALERT_EMAILS=compliance@example.com,admin@example.com

# SMTP server for alert emails
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USERNAME=your-email@example.com
# SMTP_PASSWORD=your-app-password
# SMTP_FROM=noreply@example.com

# Alert threshold for poor execution quality (fill rate %)
COMPLIANCE_ALERT_FILL_RATE_THRESHOLD=95.0

# Alert threshold for high reject rate (%)
COMPLIANCE_ALERT_REJECT_RATE_THRESHOLD=5.0

# Alert threshold for routing concentration (%)
COMPLIANCE_ALERT_ROUTING_CONCENTRATION_THRESHOLD=80.0

# ============================================================================
# Regulatory Filing
# ============================================================================

# Automatically generate quarterly reports
COMPLIANCE_AUTO_GENERATE_QUARTERLY=true

# SEC EDGAR credentials (for automated filing)
# SEC_EDGAR_CIK=0001234567
# SEC_EDGAR_CCC=12345678
# SEC_EDGAR_FILER_ID=your-filer-id

# ESMA portal credentials (for MiFID II filing)
# ESMA_PORTAL_USERNAME=your-username
# ESMA_PORTAL_PASSWORD=your-password
# ESMA_FIRM_ID=your-firm-id

# ============================================================================
# Database
# ============================================================================

# Database connection for compliance data
# Uses main database by default, but can override
# COMPLIANCE_DB_HOST=localhost
# COMPLIANCE_DB_PORT=5432
# COMPLIANCE_DB_NAME=compliance_db
# COMPLIANCE_DB_USER=compliance_user
# COMPLIANCE_DB_PASSWORD=secure_password
# COMPLIANCE_DB_SSL_MODE=require

# ============================================================================
# Security
# ============================================================================

# Master encryption key for archive files (AES-256)
# Generate with: openssl rand -base64 32
COMPLIANCE_ENCRYPTION_KEY=your-32-byte-base64-encoded-key

# Enable encryption for archive files
COMPLIANCE_ENCRYPT_ARCHIVES=true

# Hash algorithm for audit trail (sha256, sha512)
COMPLIANCE_HASH_ALGORITHM=sha256

# Salt for hash generation (keep secret!)
COMPLIANCE_HASH_SALT=your-random-salt-string

# IP whitelist for compliance endpoints (comma-separated)
# Leave empty to allow all authenticated admins
# COMPLIANCE_IP_WHITELIST=192.168.1.0/24,10.0.0.0/8

# ============================================================================
# Audit Middleware
# ============================================================================

# Enable automatic audit logging for all API requests
AUDIT_MIDDLEWARE_ENABLED=true

# Log request bodies (WARNING: may contain sensitive data)
AUDIT_LOG_REQUEST_BODIES=false

# Log response bodies (WARNING: may contain sensitive data)
AUDIT_LOG_RESPONSE_BODIES=false

# Exclude paths from audit logging (comma-separated)
AUDIT_EXCLUDE_PATHS=/health,/metrics,/docs,/swagger.yaml

# ============================================================================
# Performance
# ============================================================================

# Enable query result caching
COMPLIANCE_CACHE_ENABLED=true

# Cache backend (memory, redis)
COMPLIANCE_CACHE_BACKEND=memory

# Redis URL for distributed caching (optional)
# COMPLIANCE_REDIS_URL=redis://localhost:6379/1

# Maximum concurrent report generations
COMPLIANCE_MAX_CONCURRENT_REPORTS=5

# Report generation timeout (seconds)
COMPLIANCE_REPORT_TIMEOUT=300

# ============================================================================
# Monitoring
# ============================================================================

# Enable compliance metrics endpoint
COMPLIANCE_METRICS_ENABLED=true

# Metrics endpoint path
COMPLIANCE_METRICS_PATH=/metrics/compliance

# Prometheus push gateway (optional)
# COMPLIANCE_PROMETHEUS_PUSHGATEWAY=http://localhost:9091

# Log level for compliance system (debug, info, warn, error)
COMPLIANCE_LOG_LEVEL=info

# ============================================================================
# Testing
# ============================================================================

# Enable test data generation
COMPLIANCE_TEST_MODE=false

# Seed for test data generation
COMPLIANCE_TEST_SEED=42

# Number of test records to generate
COMPLIANCE_TEST_RECORDS=1000

# ============================================================================
# Cleanup Jobs
# ============================================================================

# Enable scheduled cleanup of expired records
COMPLIANCE_CLEANUP_ENABLED=true

# Cleanup schedule (cron format)
# Daily at 2 AM: 0 2 * * *
COMPLIANCE_CLEANUP_SCHEDULE=0 2 * * *

# Archive schedule (cron format)
# First day of each quarter at 3 AM: 0 3 1 1,4,7,10 *
COMPLIANCE_ARCHIVE_SCHEDULE=0 3 1 1,4,7,10 *

# Chain verification schedule (cron format)
# Daily at 4 AM: 0 4 * * *
COMPLIANCE_VERIFY_CHAIN_SCHEDULE=0 4 * * *

# ============================================================================
# Development
# ============================================================================

# Enable development mode (uses sample data instead of database)
COMPLIANCE_DEV_MODE=false

# Enable CORS for local development
COMPLIANCE_DEV_CORS=true

# Allow insecure HTTP in development (disable SSL verification)
COMPLIANCE_DEV_INSECURE=false

# ============================================================================
# Example Production Configuration
# ============================================================================

# COMPLIANCE_ENABLED=true
# AUDIT_RETENTION_YEARS=7
# COMPLIANCE_ARCHIVE_PATH=s3://my-compliance-archive/
# AWS_S3_BUCKET=my-compliance-archive
# AWS_S3_REGION=us-east-1
# AWS_S3_STORAGE_CLASS=GLACIER
# COMPLIANCE_PDF_ENABLED=true
# COMPLIANCE_ALERTS_ENABLED=true
# COMPLIANCE_ALERT_EMAILS=compliance@mycompany.com,cfo@mycompany.com
# COMPLIANCE_ENCRYPTION_KEY=<32-byte-base64-key>
# COMPLIANCE_ENCRYPT_ARCHIVES=true
# AUDIT_MIDDLEWARE_ENABLED=true
# COMPLIANCE_CLEANUP_ENABLED=true
# COMPLIANCE_AUTO_GENERATE_QUARTERLY=true
